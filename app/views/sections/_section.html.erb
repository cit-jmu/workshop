<div class="panel-body-section <%= css_classes_for_section_row(section) %>">
  <div class="panel-body-section-heading">
    <h4 class="panel-body-section-title">
      <%= link_to "Section #{section.section_number}", course_section_path(section.course, section) %>
      <span class="label label-success"><%= section.open_seats %> open seats</span>
    </h4>
    <p>
      <strong>Instructor:</strong>
      <%= section.instructor.display_name %>
    </p>
  </div>

  <%= render partial: 'parts/part', collection: section.parts, layout: 'parts/panel_body_section_row' %>

  <div class="actions">
    <% if @user && @user.instructing?(:section => section) %>
      <%= link_to 'View section', course_section_path(section.course, section),
          class: 'btn btn-primary' %>
    <% elsif @user && @user.enrolled?(:section => section) %>
      <%= link_to 'Drop course', drop_course_section_path(section.course, section),
          method: :delete, class: 'btn btn-primary' %>
    <% elsif !@user || (@user && !@user.enrolled?(:course => section.course)) %>
      <%= link_to 'Enroll', enroll_course_section_path(section.course, section),
          method: :post, class: 'btn btn-primary' %>
    <% end %>

    <% if user_signed_in? && (can?(:update, section) || can?(:destroy, section)) %>
      <% if can? :update, section %>
        <%= link_to edit_course_section_path(section.course, section), class: "btn btn-default" do %>
          <span class="glyphicon glyphicon-pencil"></span>
        <% end %>
      <% end %>
      <% if can? :destroy, section %>
        <%= link_to [section.course, section], method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-default" do %>
          <span class="glyphicon glyphicon-trash"></span>
        <% end %>
      <% end %>
    <% end %>
  </div>
</div>
